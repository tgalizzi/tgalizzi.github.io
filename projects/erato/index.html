<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Théo  Galizzi


  | Erato

</title>
<meta name="description" content="A beautiful, simple, clean, and responsive Jekyll theme for academics">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<!-- 
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">
 -->

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://tgalizzi.github.io/projects/erato/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>


    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/assets/js/distillpub/overrides.js"></script>
    
    
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Erato",
      "description": "Réseau de neuronnes pour la génération de poèmes",
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      <!-- <a class="navbar-brand title font-weight-lighter" href="https://tgalizzi.github.io/"><span class="font-weight-bold">Théo</span>   Galizzi</a>
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              <i class="fas fa-user fa-sm"></i>
            <b>A propos de moi</b>
              <!--  -->
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/stages/">
              <i class="fas fa-briefcase"></i>
              <b>Stages</b>
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/formation/">
                
                <i class="fas fa-graduation-cap fa-sm"></i>
                
                
                <b>Formation</b>
                
              </a>
          </li>
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                
                
                <i class="fas fa-lightbulb fa-sm"></i>
                
                <b>Projets</b>
                
              </a>
          </li>
          
          
          
          
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="post distill">

      <d-title>
        <h1>Erato</h1>
        <p>Réseau de neuronnes pour la génération de poèmes</p>
         <p> <i class="fas fa-calendar fa-sm"></i> 2021         
        
      </p></d-title>

      <d-byline></d-byline>
      <d-article>
        
        <d-contents>
          <nav class="l-text figcaption">
          <h3>Sommaire</h3>
            
            <div><a href="#abstract">Abstract</a></div>
            
            
            <div><a href="#le-contexte-du-projet">Le contexte du projet</a></div>
            
            
            <div><a href="#les-donn%C3%A9es">Les données</a></div>
            
            
            <div><a href="#mod%C3%A8le-seq2seq">Modèle Seq2Seq</a></div>
            
            
            <div><a href="#bert">Bert</a></div>
            
            
          </nav>
        </d-contents>
        

        <p><strong><em>Note</em></strong>:
Ce projet a été réalisé pour le cours <a href="https://cocoxu.github.io/CS7650_fall2021/" target="_blank" rel="noopener noreferrer"><strong>CS 7650 - Natural Language Processing</strong></a> lors de mon cursus à Georgia Tech. J’ai travaillé en colaboration avec <strong>Victor Galizzi</strong> et <strong>Martin Puig</strong>.</p>

<h2 id="abstract">Abstract</h2>

<p>La génération de textes convaincants est un défi majeur du traitement automatique des langues. Certaines architectures précédentes, telles que Seq2Seq, ont fourni des résultats intéressants, mais toujours très éloignés du flux naturel de la parole humaine. Dans ce projet, nous discutons de différentes manières de créer des textes encore plus convaincants, dans un contexte qui s’oppose normalement à l’informatique : la poésie.</p>

<h2 id="le-contexte-du-projet">Le contexte du projet</h2>

<p>La génération de texte à l’aide de modèles Seq2seq simples a tendance à générer des réponses sèches et banales telles que <em>“Je ne sais pas”</em> dans le cas des chatbots. Dans ce projet, nous explorons plusieurs techniques pour générer des textes plus spécifiques en utilisant un contexte, et nous travaillons sur la génération de poésie car la poésie est un exemple parfait de génération de texte qui nécessite verbosité et spécificité pour être crédible. Bien qu’il soit compliqué de trouver des métriques pertinentes pour ce type de tâche, nous nous sommes efforcés de comparer différentes architectures, en utilisant des métriques d’évaluation automatique, ainsi qu’en comparant la qualité de sorties sélectionnées. Nous avons exploré différentes techniques de génération basées sur un contexte d’entrée et une cible variés, en utilisant des exemples de vers, de mots-clés ou d’auteurs de poèmes.</p>

<h2 id="les-données">Les données</h2>

<p>Notre base de données contient 573 poèmes de différents poètes et époques, avec 5 attributs différents : auteur, poème, titre, époque, type. Il y a deux époque différentes : <strong>Renaissance</strong>, <strong>Moderne</strong> et trois types différents : <strong>Mythologie &amp; Folklore</strong>, <strong>Nature</strong>, <strong>Amour</strong>. Tout en gardant l’idée dans notre projet, nous n’avons pas utilisé l’attribut type, trop générique, ni l’époques, déjà codé avec l’auteur. 
Nous avons choisi cette base de données plutôt que des ensembles plus importants pour deux raisons principales :</p>

<ul>
  <li>Il ne contient que des poèmes classiques, par rapport aux grandes bases de données remplies de poèmes contemporains. Les poèmes classiques sont plus structurés, ce qui les rend plus faciles à reconnaître, à évaluer et probablement à générer.</li>
  <li>Notre puissance de calcul était trop modeste pour fine-tune les gros modèles tels que BART et BERT sur de grandes bases de données.</li>
</ul>

<h2 id="modèle-seq2seq">Modèle Seq2Seq</h2>

<p>Ce modèle a été formé de deux manières différentes. Tout d’abord, pour les deux modèles, nous commençons nos entrées par l’auteur, pour essayer de capturer les différents styles entre les auteurs. Nous introduisons également un nouveau séparateur, $<sep>$.
Après le jeton séparateur, les modèles diffèrent :</sep></p>
<ul>
  <li>Lines : nous divisons chaque poème en lignes, et essayons de prédire la ligne suivante du poème en utilisant la ligne actuelle. <br>
  <strong>input</strong> : AUTHOR \(&lt;sep&gt;\) \(ligne_i\)  <strong>|</strong>  <strong>target</strong> : \(ligne_{i+1}\).</li>
  <li>
    <p>Mots clés : nous divisons chaque poème en lignes, et essayons de prédire la ligne du poème en utilisant les 3 mots les plus rares de la ligne.</p>

    <p><strong>input</strong> : AUTEUR \(&lt;sep&gt;\) \(w_1\) \(w_2\) \(w_3\)  <strong>|</strong>  <strong>target</strong> : \(ligne_{i}\)</p>
  </li>
</ul>

<p>Pour créer un poème, nous générons chaque ligne séquentiellement en utilisant la recherche par faisceau. Ensuite, les scores de chaque faisceau sont normalisés, et nous choisissons un faisceau aléatoire pour être notre prochaine ligne en utilisant les scores normalisés. Pendant la génération, nous avons un contexte représenté par des mots clés.
En plus des mots clés que nous donnons aux modèles, nous utilisons également des mots aléatoires de la ligne actuelle pour produire la suivante. Ceci est utile pour ajouter la généralisation et le caractère aléatoire pendant la génération.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/erato/seq1-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/erato/seq1-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/erato/seq1-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/erato/seq1.png" title="" data-zoomable="">

  </picture>

  

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/erato/seq2-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/erato/seq2-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/erato/seq2-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/erato/seq2.png" title="" data-zoomable="">

  </picture>

  

</figure>

    </div>
</div>
<div class="caption">
Comparaison d'auteur
</div>

<div class="row justify-content-center">
    <div class="col-md-auto">
        

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/erato/seq3-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/erato/seq3-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/erato/seq3-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/erato/seq3.png" title="" data-zoomable="">

  </picture>

  

</figure>

    </div>
</div>
<div class="caption">
William Shakespear
</div>

<h2 id="bart">Bart</h2>

<p>Nous avons ensuite voulu comparer notre modèle simple avec un modèle NLP de pointe. Nous avons choisi BART \cite{BART}, qui est un encodeur-décodeur transformateur. L’encodeur est un encodeur bidirectionnel similaire à BERT, et le décodeur est un transformateur autorégressif, similaire à GPT. L’utilisation de ce modèle nous permet de tirer profit du pré-entraînement. En utilisant la bibliothèque Hugging face transformers, nous avons chargé un DistilBART pré-entraîné.</p>

<p>Nous affinons ensuite deux modèles de la même manière que celle décrite dans la section GRU, et obtenons un générateur de ligne BART (prenant un auteur et une ligne en entrée et générant une ligne) et un générateur de contexte BART (auteur + contexte pour générer une ligne). Les deux modèles ont été entraînés pendant 8 époques avec une taille de lot de 16.</p>

<p>Après quelques expériences, nous sommes arrivés à notre générateur de poèmes BART final : nous utilisons le générateur de contexte BART pour obtenir une ligne à partir d’un auteur et d’un contexte. Nous utilisons ensuite le générateur de lignes BART pour produire le reste du poème, en donnant séquentiellement au modèle l’auteur et la ligne précédente. Dans les deux cas, la génération est faite en utilisant l’échantillonnage top-k.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/erato/poem1-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/erato/poem1-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/erato/poem1-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/erato/poem1.png" title="" data-zoomable="">

  </picture>

  

</figure>

    </div>
</div>
<div class="caption">
William Shakespear
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/erato/poem2-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/erato/poem2-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/erato/poem2-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/erato/poem2.png" title="" data-zoomable="">

  </picture>

  

</figure>

    </div>
</div>
<div class="caption">
William Shakespear
</div>

<p><br><br></p>

      </d-article>

      <!-- <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix> -->

    </div>

    <!-- Footer -->

    <!-- 
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2022 Théo  Galizzi.
    
    
    
  </div>
</footer>

 -->

  </body>

  <!-- <d-bibliography src="/assets/bibliography/">
  </d-bibliography> -->

</html>
